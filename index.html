<!DOCTYPE html>
<html lang="fr" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RounteSync API</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="index.css">
    <style>

        .dark-mode .leaflet-layer,
.dark-mode .leaflet-control-zoom-in,
.dark-mode .leaflet-control-zoom-out,
.dark-mode .leaflet-control-attribution {
    filter: invert(100%) hue-rotate(180deg) brightness(95%) contrast(90%);
}


        .dark-mode .form-input {
            background-color: transparent; /* Couleur de fond plus sombre */
            color: white; /* Texte blanc */
            border-color: #555; /* Bordure plus sombre */
        }

        .dark-mode .flex.flex-col {
            background-color: #282a36; /* Arrière-plan plus sombre pour le conteneur */
        }
        .dark-mode .form-input::placeholder {
            background-color: transparent;
            color: white;
        }
        #map {
            height: 100vh;
            width: 100vw;
        }



        .custom-layout {
            width: 600px;
            height: 100vh;
            margin: 0 auto; /* Centrer le layout horizontalement */
            scrollbar-width: none; /* Pour Firefox */

        }

        .custom-layout::-webkit-scrollbar {
            display: none; /* Pour Chrome, Safari, et autres navigateurs WebKit/Blink */
        }

    </style>
</head>
<body>
<div class="flex font-sans">

    <div class="custom-layout font-sans font-bold overflow-y-auto ">

        <div class="w-full h-[322px] bg-routesyncgreen pt-6 relative">
                <h1 class="text-2xl mb-8 text-white flex items-center ml-[3.5vw]"><span class="font-light">Route</span><em>Sync</em>
                    <span class="ml-5 px-3 py-1 text-xs bg-white text-black rounded-full">Paris</span>
                    <label class="swap swap-rotate ml-24">
                        <input type="checkbox" class="theme-controller" value="dracula" />
                        <svg class="swap-off fill-current w-10 h-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/></svg>
                        <svg class="swap-on fill-current w-10 h-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/></svg>
                    </label>
                </h1>

        <!--    <div class="flex flex-col">
                <input type="text" placeholder="Départ"
                       class="input  input-bordered w-full max-w-xs rounded-md mb-5 mx-auto block opacity-40 focus:opacity-100"/>
                <input type="text" placeholder="Destination"
                       class="input input-bordered w-full  max-w-xs rounded-md mx-auto block opacity-40 focus:opacity-100"/>
            </div>-->

            <div class="flex flex-col p-4 bg-white rounded-md shadow-lg w-80 mx-auto">
                <div class="flex items-center mb-1">
                    <div class="bg-blue-400 rounded-full h-4 w-4 flex-shrink-0"></div>
                    <input type="text" placeholder="Départ" class="bg-white form-input ml-2 flex-1 text-gray-600 focus:outline-none"/>
                </div>
                <div class="h-px bg-gray-300 mx-6 my-2"></div> <!-- Ajusté avec mx-6 pour centrer le divider -->
                <div class="flex items-center mt-1">
                    <div class="bg-[#199675] rounded-full h-4 w-4 flex-shrink-0"></div>
                    <input type="text" placeholder="Destination" class="bg-white form-input ml-2 flex-1 text-gray-600 focus:outline-none"/>
                </div>
            </div>



            <div class="fixed right-4 top-16 transform translate-y-1/2">
            <div class="w-12 h-12 rounded-full bg-white flex items-center justify-center shadow-lg">
                <i class="fas fa-sync-alt text-routesyncgreen"></i>
            </div>
        </div>
        <button
                class="btn btn-block rounded-md mt-8 bg-[#199675] w-full max-w-xs border-transparent text-white mx-auto block text-md font-medium hover:bg-[#16a085] hover:border-transparent">Rechercher
        </button>
    </div>







    <div>
        <h1 class="ml-12 mt-8 mb-5">Administration de la carte</h1>
        <div class="flex space-x-2 justify-center">
            <button class="px-3 py-2 text-xs bg-white border border-gray-400 text-black rounded-full hover:border-green-500 hover:text-green-900" onclick="displayAll()">Réinitialiser la carte</button>
            <button class="px-2 py-1 text-xs bg-white border border-gray-400  text-black rounded-full  hover:border-green-500 hover:text-green-900">Vérifier connexité</button>
            <button class="px-2 py-1 text-xs bg-white border border-gray-400  text-black rounded-full  hover:border-green-500 hover:text-green-900">Afficher l'ACPM</button>
        </div>


        <div class="divider mx-8"></div>
        <h1 class="ml-12 mt-5 mb-5">Métro</h1>
        <div class="grid grid-cols-4 gap-4 px-10">
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne1.svg' onclick="fetchStops('ligne1', '#FFBE00')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne2.svg' onclick="fetchStops('ligne2', '#0055C8')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne3.svg' onclick="fetchStops('ligne3', '#6E6E00')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne3bis.svg' onclick="fetchStops('ligne3b', '#6EC4E8')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne4.svg' onclick="fetchStops('ligne4', '#A0006E')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne5.svg' onclick="fetchStops('ligne5', '#FF7E2E')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne6.svg' onclick="fetchStops('ligne6', '#6ECA97')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne7.svg' onclick="fetchStops('ligne7_2', '#F49FB3')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne7bis.svg' onclick="fetchStops('ligne7b', '#6ECA97')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne8.svg' onclick="fetchStops('ligne8', '#D282BE')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne9.svg' onclick="fetchStops('ligne9', '#B6BD00')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne10.svg' onclick=" fetchStops('ligne10', '#C9910D')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne11.svg' onclick="fetchStops('ligne11', '#704B1C')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne12.svg' onclick="fetchStops('ligne12', '#007852')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne13.svg' onclick="fetchStops('ligne13', '#6EC4E8')" alt="SVG Description" class="svg-icon"/>
            </div>
            <div class="p-2 border-4 rounded-lg flex items-center justify-center">
                <img src='svg/ligne14.svg' onclick="fetchStops('ligne14', '#62259D')" alt="SVG Description" class="svg-icon"/>
            </div>
        </div>
    </div>

</div>
    <div id="map"></div><br>
</div>




<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://kit.fontawesome.com/e22cda2001.js" crossorigin="anonymous"></script>
<script>

    // Sélectionnez les champs d'entrée
    const inputs = document.querySelectorAll('.input');

    // Ajoutez un écouteur d'événements à chaque champ d'entrée
    inputs.forEach(input => {
        input.addEventListener('input', () => {
            // Si le champ d'entrée n'est pas vide, définissez l'opacité à 70
            if (input.value.trim() !== '') {
                input.style.opacity = '0.7';
            }
            // Sinon, rétablissez l'opacité à 20
            else {
                input.style.opacity = '0.2';
            }
        });
    });

    document.querySelector('.theme-controller').addEventListener('change', function(e) {
        var body = document.body;
        if (e.target.checked) {
            body.classList.add('dark-mode');
        } else {
            body.classList.remove('dark-mode');
        }
        updateMapTheme(e.target.checked ? 'dracula' : 'light');
    });
    var map = L.map('map').setView([48.8566, 2.3522], 12);
    L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: 'Réalisé pour EFREI'
    }).addTo(map);

    async function fetchStops(line, color) {
        clearMap();
        const response = await fetch(`http://localhost:8000/stops/${line}`);
        const stops = await response.json();
        const latLngs = [];

        stops.forEach(stop => {
            latLngs.push([stop.lat, stop.lon]);
            const circle = L.circle([stop.lat, stop.lon], {
                color: color,
                fillColor: color,
                fillOpacity: 1,
                radius: 50,
                weight: 6
            }).addTo(map);
            circle.bindPopup(`Arrêt: ${stop.stop_name}`);
        });



        L.polyline(latLngs, {color: color}).addTo(map);
        map.fitBounds(L.polyline(latLngs).getBounds());
    }

    function fetchLigne7() {
        clearMap();
        fetchStops('ligne7', '#F49FB3');
        fetchStops('ligne7_2', '#F49FB3');
    }

    function displayAll() {
        clearMap();
        fetchStops('ligne5', '#FF7E2E');
        fetchStops('ligne7', '#F49FB3');
        fetchStops('ligne1', '#FFBE00');
        fetchStops('ligne2', '#0055C8');
        fetchStops('ligne6', '#6ECA97');
        fetchStops('ligne3', '#6E6E00');
        fetchStops('ligne4', '#A0006E');
        fetchStops('ligne9', '#B6BD00');
        fetchStops('ligne8', '#D282BE');
        fetchStops('ligne13', '#6EC4E8');
        fetchStops('ligne14', '#62259D');
        fetchStops('ligne7_2', '#F49FB3');
        fetchStops('ligne11', '#704B1C');
        fetchStops('ligne12', '#007852');
        fetchStops('ligne7b', '#6ECA97');
        fetchStops('ligne3b', '#6EC4E8');
        fetchStops('ligne10', '#C9910D');
    }

    function clearMap() {
        map.eachLayer(function(layer) {
            if (layer instanceof L.Circle || layer instanceof L.Polyline) {
                map.removeLayer(layer);
            }
        });
    }
    displayAll()
</script>
</body>
</html>
