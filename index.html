<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte des arrêts de métro</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map { height: 600px; width: 800px; }
    </style>
</head>
<body>
<div id="map"></div>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    var map = L.map('map').setView([48.8566, 2.3522], 12); // Centre sur Paris

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '© OpenStreetMap'
    }).addTo(map);

    // Définis une icône personnalisée plus petite
    var smallIcon = L.icon({
        iconUrl: 'https://leafletjs.com/examples/custom-icons/leaf-red.png',
        iconSize: [20, 20], // taille de l'icône
        iconAnchor: [10, 10] // point de l'icône qui correspond à la position du marqueur
    });

    async function fetchStops() {
        const response = await fetch('http://localhost:8000/stops'); // Remplace par l'URL de ton API
        const stops = await response.json();
        const latLngs = [];

        stops.forEach(stop => {
            const marker = L.marker([stop.lat, stop.lon], {icon: smallIcon}).addTo(map);
            marker.bindPopup(`Arrêt: ${stop.stop_id}`);
            latLngs.push([stop.lat, stop.lon]);
        });

        // Dessine une ligne orange entre les arrêts
        const polyline = L.polyline(latLngs, {color: 'orange'}).addTo(map);
        map.fitBounds(polyline.getBounds());
    }

    fetchStops();
</script>
</body>
</html>
